{% extends 'base.html' %}
{% load humanize %}

{% block title %}Payment Successful{% endblock %}

{% block content %}
<style>
    .back-link { font-size: 0.85rem; color: var(--text-muted); text-decoration: none; margin-bottom: 20px; display: inline-block; }
    .back-link:hover { color: var(--accent-primary); }
    .success-page { max-width: 450px; margin: 40px auto; padding: 20px; text-align: center; }
    .success-icon { width: 60px; height: 60px; background: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; }
    .success-icon svg { width: 30px; height: 30px; color: white; }
    .success-title { font-size: 1.3rem; font-weight: 600; margin-bottom: 5px; }
    .success-subtitle { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 20px; }
    .info-card { background: var(--bg-secondary); border-radius: 8px; padding: 15px; margin-bottom: 15px; text-align: left; }
    .info-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 0.85rem; border-bottom: 1px solid var(--border-color); }
    .info-row:last-child { border-bottom: none; }
    .info-row span:first-child { color: var(--text-muted); }
    .info-row span:last-child { font-weight: 500; }
    .emi-card { background: rgba(99, 102, 241, 0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px; text-align: left; }
    .emi-title { font-size: 0.8rem; font-weight: 600; color: var(--accent-primary); margin-bottom: 10px; }
    .emi-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .emi-item small { display: block; font-size: 0.7rem; color: var(--text-muted); }
    .emi-item strong { font-size: 0.85rem; }
    .email-note { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 15px; }
    .btn-home { display: block; width: 100%; padding: 10px; background: var(--accent-primary); color: white; border: none; border-radius: 6px; font-size: 0.9rem; text-decoration: none; margin-bottom: 8px; }
    .btn-home:hover { opacity: 0.9; color: white; }
    .btn-browse { display: block; width: 100%; padding: 10px; background: transparent; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem; text-decoration: none; color: var(--text-primary); }
    .btn-browse:hover { border-color: var(--accent-primary); color: var(--accent-primary); }
</style>
<div class="success-page" style="max-width:450px;margin:10px auto; text-align:left;">
    <a href="{% url 'profile' %}" class="back-link">
        <svg class="arrow-svg arrow-left" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Back to Profile
    </a>
</div>
<div class="success-page">
    <div class="success-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
    </div>
    
    <h1 class="success-title">Payment Successful!</h1>
    <p class="success-subtitle">Your transaction has been completed</p>
    
    <div class="info-card">
        <div class="info-row">
            <span>Transaction ID</span>
            <span>{{ payment.transaction_id }}</span>
        </div>
        <div class="info-row">
            <span>Amount Paid</span>
            <span style="color: #10b981;">₹{{ payment.amount|intcomma }}</span>
        </div>
        <div class="info-row">
            <span>Payment Method</span>
            <span>{{ payment.get_payment_method_display }}</span>
        </div>
        <div class="info-row">
            <span>Date</span>
            <span>{{ payment.payment_date|date:"d M Y" }}</span>
        </div>
        <div class="info-row">
            <span>Car</span>
            <span>{{ payment.car.brand }} {{ payment.car.name }}</span>
        </div>
    </div>

    {% if emi_plan %}
    <div class="emi-card">
        <div class="emi-title">EMI Plan Activated</div>
        <div class="emi-grid">
            <div class="emi-item">
                <small>Monthly EMI</small>
                <strong>₹{{ emi_plan.monthly_emi|intcomma }}</strong>
            </div>
            <div class="emi-item">
                <small>Tenure</small>
                <strong>{{ emi_plan.tenure_months }} months</strong>
            </div>
            <div class="emi-item">
                <small>Interest Rate</small>
                <strong>{{ emi_plan.interest_rate }}%</strong>
            </div>
            <div class="emi-item">
                <small>Next Due</small>
                <strong>{{ emi_plan.next_due_date|date:"d M Y" }}</strong>
            </div>
        </div>
    </div>
    {% endif %}
    
    <p class="email-note">Confirmation sent to {{ payment.customer.email }}</p>
    
    <a href="{% url 'home' %}" class="btn-home">Back to Home</a>
    <a href="{% url 'car_list' %}" class="btn-browse">Browse More Cars</a>
</div>
{% endblock %}
